<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹ ë‚˜ëŠ” êµ¬êµ¬ë‹¨ ì—°ìŠµ!</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f8ff;
            text-align: center;
            flex-direction: column;
        }
        .container {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            min-width: 350px;
        }
        h1 {
            color: #0056b3;
            margin-bottom: 20px;
        }
        /* êµ¬êµ¬ë‹¨ ì„ íƒ ì¶”ê°€ */
        .dan-selector {
            margin-bottom: 20px;
        }
        .dan-selector label {
            margin-right: 10px;
            font-size: 1.1em;
            color: #555;
        }
        .dan-selector select {
            padding: 8px 12px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        #problem {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #333;
            font-weight: bold;
        }
        input[type="number"] {
            padding: 15px;
            font-size: 1.5em;
            width: 100px;
            text-align: center;
            border: 2px solid #ccc;
            border-radius: 8px;
            margin-bottom: 10px;
            -moz-appearance: textfield;
        }
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .button-group {
            margin-top: 10px;
            margin-bottom: 20px;
        }
        button {
            padding: 12px 20px;
            font-size: 1.1em;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            margin: 5px;
            transition: background-color 0.3s ease, opacity 0.3s ease;
            min-width: 100px;
        }
        button:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
        #checkBtn {
            background-color: #28a745;
            color: white;
        }
        #checkBtn:hover:not(:disabled) {
            background-color: #218838;
        }
        #showAnswerBtn {
            background-color: #ffc107;
            color: #333;
        }
        #showAnswerBtn:hover:not(:disabled) {
            background-color: #e0a800;
        }
         #nextBtn {
            background-color: #007bff;
            color: white;
        }
        #nextBtn:hover:not(:disabled) {
            background-color: #0056b3;
        }
        #feedback {
            margin-top: 20px;
            font-size: 1.3em;
            font-weight: bold;
            min-height: 30px;
            color: #555;
        }
        .correct {
            color: green;
        }
        .incorrect {
            color: red;
        }
        .corrected { /* ì˜¤ë‹µ ìˆ˜ì • ì‹œ ì‚¬ìš©í•  ìŠ¤íƒ€ì¼ */
            color: darkorange;
        }
        #score-area { /* ì ìˆ˜ ì˜ì—­ ë¬¶ê¸° */
             margin-top: 15px;
             font-size: 1.1em;
             color: #555;
        }
        #score-area div {
             margin-bottom: 5px; /* ì ìˆ˜ í•­ëª© ê°„ ê°„ê²© */
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ì‹ ë‚˜ëŠ” êµ¬êµ¬ë‹¨ ì—°ìŠµ! ğŸ‰</h1>

    <!-- êµ¬êµ¬ë‹¨ ì„ íƒ ë“œë¡­ë‹¤ìš´ -->
    <div class="dan-selector">
        <label for="danSelect">ëª‡ ë‹¨ì„ ì—°ìŠµí• ê¹Œìš”?</label>
        <select id="danSelect">
            <option value="all">ì „ì²´</option>
            <option value="2">2ë‹¨</option>
            <option value="3">3ë‹¨</option>
            <option value="4">4ë‹¨</option>
            <option value="5">5ë‹¨</option>
            <option value="6">6ë‹¨</option>
            <option value="7">7ë‹¨</option>
            <option value="8">8ë‹¨</option>
            <option value="9">9ë‹¨</option>
        </select>
    </div>

    <div id="problem">? x ? = ?</div>

    <input type="number" id="answer" placeholder="ì •ë‹µ ì…ë ¥" autofocus>

    <div class="button-group">
        <button id="checkBtn">í™•ì¸</button>
        <button id="showAnswerBtn" disabled>ì •ë‹µ ë³´ê¸°</button>
         <button id="nextBtn" disabled>ë‹¤ìŒ ë¬¸ì œ</button>
    </div>

    <div id="feedback">ì—°ìŠµí•  ë‹¨ì„ ì„ íƒí•˜ê³  ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”!</div>

    <!-- ì ìˆ˜ í‘œì‹œ ì˜ì—­ ìˆ˜ì • -->
    <div id="score-area">
        <div id="problemsSolved">í‘¼ ë¬¸ì œ: 0</div> <!-- í‘¼ ë¬¸ì œ ìˆ˜ -->
        <div id="correctAnswers">ì •ë‹µ (ì²« ì‹œë„): 0</div> <!-- ì •ë‹µ ìˆ˜ -->
        <div id="correctionScore">ì˜¤ë‹µ ìˆ˜ì •: 0ë²ˆ ğŸ‘</div>
    </div>

</div>

<script>
    const problemElement = document.getElementById('problem');
    const answerInput = document.getElementById('answer');
    const checkBtn = document.getElementById('checkBtn');
    const nextBtn = document.getElementById('nextBtn');
    const showAnswerBtn = document.getElementById('showAnswerBtn');
    const feedbackElement = document.getElementById('feedback');
    const problemsSolvedElement = document.getElementById('problemsSolved'); // í‘¼ ë¬¸ì œ ìˆ˜ ìš”ì†Œ
    const correctAnswersElement = document.getElementById('correctAnswers'); // ì •ë‹µ ìˆ˜ ìš”ì†Œ
    const correctionScoreElement = document.getElementById('correctionScore');
    const danSelect = document.getElementById('danSelect'); // êµ¬êµ¬ë‹¨ ì„ íƒ ìš”ì†Œ

    let num1, num2, correctAnswer;
    let problemsPresentedCount = 0; // ì´ í‘¼ ë¬¸ì œ ìˆ˜ (ê³„ì† ëˆ„ì )
    let firstTryCorrectCount = 0;   // ì²« ì‹œë„ ì •ë‹µ íšŸìˆ˜ (ê³„ì† ëˆ„ì )
    let correctionCount = 0;        // ì˜¤ë‹µ ìˆ˜ì • íšŸìˆ˜ (ê³„ì† ëˆ„ì )

    let isRetry = false; // í˜„ì¬ ë¬¸ì œê°€ ì¬ì‹œë„ì¸ì§€ ì—¬ë¶€ í”Œë˜ê·¸

    // ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜
    function setButtonState(checkEnabled, showAnswerEnabled, nextEnabled) {
        checkBtn.disabled = !checkEnabled;
        showAnswerBtn.disabled = !showAnswerEnabled;
        nextBtn.disabled = !nextEnabled;
        answerInput.disabled = !checkEnabled;
        if (checkEnabled) {
            answerInput.focus(); // ì…ë ¥ ê°€ëŠ¥ ìƒíƒœì¼ ë•Œ í¬ì»¤ìŠ¤
        }
    }

    // ì ìˆ˜ í‘œì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateScoreDisplay() {
        problemsSolvedElement.textContent = `í‘¼ ë¬¸ì œ: ${problemsPresentedCount}`;
        correctAnswersElement.textContent = `ì •ë‹µ (ì²« ì‹œë„): ${firstTryCorrectCount}`;
        correctionScoreElement.textContent = `ì˜¤ë‹µ ìˆ˜ì •: ${correctionCount}ë²ˆ ğŸ‘`;
    }

    // ëœë¤ êµ¬êµ¬ë‹¨ ë¬¸ì œ ìƒì„± í•¨ìˆ˜
    function generateProblem() {
        problemsPresentedCount++; // ë¬¸ì œ ìˆ˜ ì¦ê°€ (ì œí•œ ì—†ìŒ)
        isRetry = false; // ìƒˆ ë¬¸ì œëŠ” í•­ìƒ ì²« ì‹œë„

        const selectedDan = danSelect.value;

        if (selectedDan === "all") {
            // ì „ì²´ ì„ íƒ ì‹œ: 2ë‹¨ ~ 9ë‹¨ ëœë¤
            num1 = Math.floor(Math.random() * 8) + 2;
        } else {
            // íŠ¹ì • ë‹¨ ì„ íƒ ì‹œ: í•´ë‹¹ ë‹¨ìœ¼ë¡œ ê³ ì •
            num1 = parseInt(selectedDan);
        }
        // ê³±í•˜ëŠ” ìˆ˜ëŠ” í•­ìƒ 1 ~ 9 ëœë¤
        num2 = Math.floor(Math.random() * 9) + 1;
        correctAnswer = num1 * num2;

        problemElement.textContent = `${num1} x ${num2} = ?`;
        if (problemsPresentedCount === 1) { // ì²« ë¬¸ì œì¼ ê²½ìš° ì•ˆë‚´ ë©”ì‹œì§€ ìœ ì§€
             feedbackElement.textContent = 'ë¬¸ì œë¥¼ ë³´ê³  ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”!';
        } else {
             feedbackElement.textContent = 'ë‹¤ìŒ ë¬¸ì œì…ë‹ˆë‹¤! ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”.';
        }
        feedbackElement.className = '';
        answerInput.value = '';

        setButtonState(true, false, false); // í™•ì¸ í™œì„±í™”, ì •ë‹µë³´ê¸°/ë‹¤ìŒ ë¹„í™œì„±í™”
        updateScoreDisplay(); // ì ìˆ˜íŒ ì—…ë°ì´íŠ¸
    }

    // ì •ë‹µ í™•ì¸ í•¨ìˆ˜
    function checkAnswer() {
        const userAnswer = parseInt(answerInput.value);

        if (isNaN(userAnswer)) {
            feedbackElement.textContent = 'ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!';
            feedbackElement.className = 'incorrect';
            answerInput.value = '';
            answerInput.focus();
            return;
        }

        if (userAnswer === correctAnswer) {
            if (!isRetry) { // ì²« ì‹œë„ì— ì •ë‹µ
                feedbackElement.textContent = 'ì •ë‹µ! ğŸ‘';
                feedbackElement.className = 'correct';
                firstTryCorrectCount++; // ì²« ì‹œë„ ì •ë‹µ ì ìˆ˜ ì¦ê°€
            } else { // ì¬ì‹œë„ ëì— ì •ë‹µ
                feedbackElement.textContent = 'ì˜¤ë‹µì„ ìˆ˜ì •í–ˆì–´ìš”! ì˜í–ˆì–´ìš”! ğŸ˜Š';
                feedbackElement.className = 'corrected';
                correctionCount++; // ì˜¤ë‹µ ìˆ˜ì • íšŸìˆ˜ ì¦ê°€
            }
            updateScoreDisplay(); // ì ìˆ˜íŒ ì—…ë°ì´íŠ¸
            setButtonState(false, false, true); // ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ í™œì„±í™”

        } else { // ì˜¤ë‹µì¸ ê²½ìš°
            feedbackElement.textContent = `ì˜¤ë‹µ! ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜ ì •ë‹µì„ í™•ì¸í•˜ì„¸ìš”. ğŸ¤”`;
            feedbackElement.className = 'incorrect';
            isRetry = true; // ì´ì œ ì´ ë¬¸ì œëŠ” ì¬ì‹œë„ ìƒíƒœê°€ ë¨
            answerInput.value = '';
            setButtonState(true, true, false); // í™•ì¸(ì¬ì‹œë„), ì •ë‹µ ë³´ê¸° í™œì„±í™”
        }
    }

    // ì •ë‹µ ë³´ê¸° í•¨ìˆ˜
    function showAnswer() {
        feedbackElement.textContent = `ì •ë‹µì€ ${correctAnswer} ì…ë‹ˆë‹¤. ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.`;
        feedbackElement.className = 'incorrect'; // ì •ë‹µì„ ë´¤ìœ¼ë¯€ë¡œ ì˜¤ë‹µ ì²˜ë¦¬ì™€ ìœ ì‚¬í•˜ê²Œ í‘œì‹œ
        isRetry = false; // ì •ë‹µì„ ë´¤ìœ¼ë¯€ë¡œ ì¬ì‹œë„ ìƒíƒœ í•´ì œ
        setButtonState(false, false, true); // ë‹¤ìŒ ë¬¸ì œ í™œì„±í™”
        // ì •ë‹µì„ ë³¸ ê²½ìš°ëŠ” firstTryCorrectCountë‚˜ correctionCountë¥¼ ì¦ê°€ì‹œí‚¤ì§€ ì•ŠìŒ
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    checkBtn.addEventListener('click', checkAnswer);
    nextBtn.addEventListener('click', generateProblem);
    showAnswerBtn.addEventListener('click', showAnswer);
    danSelect.addEventListener('change', generateProblem); // ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì‹œ ìƒˆ ë¬¸ì œ ìƒì„±

    // Enter í‚¤ ì²˜ë¦¬
    answerInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            event.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€ (í¼ ì œì¶œ ë“±)
            if (!checkBtn.disabled) { // í™•ì¸ ë²„íŠ¼ì´ í™œì„±í™” ë˜ì–´ ìˆì„ ë•Œ
                checkAnswer();
            } else if (!nextBtn.disabled) { // ë‹¤ìŒ ë¬¸ì œ ë²„íŠ¼ì´ í™œì„±í™” ë˜ì–´ ìˆì„ ë•Œ
                generateProblem();
            }
            // ì •ë‹µ ë³´ê¸° ë²„íŠ¼ë§Œ í™œì„±í™”ëœ ê²½ìš° Enterë¡œ ë™ì‘í•˜ì§€ ì•ŠìŒ (ì˜¤ì…ë ¥ ë°©ì§€)
        }
    });

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë¬¸ì œ ìƒì„± (ì¹´ìš´í„°ëŠ” 0ì—ì„œ ì‹œì‘, generateProblemì—ì„œ 1ë¡œ ë§Œë“¦)
    generateProblem();

</script>

</body>
</html>
